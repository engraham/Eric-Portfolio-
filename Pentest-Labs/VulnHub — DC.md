# Lab Report: VulnHub DC:1 — Foothold → Privilege Escalation → Exfiltration

---

## Table of Contents
- [Executive Summary](#executive-summary)
- [Objective](#objective)
- [Lab Setup](#lab-setup)
- [Methodology](#methodology)
- [Reconnaissance](#reconnaissance)
- [Exploitation Chain](#exploitation-chain)
  - [Initial Foothold](#initial-foothold)
  - [Privilege Escalation](#privilege-escalation)
  - [Pivot & Exfiltration](#pivot--exfiltration)
- [Post-Exploitation](#post-exploitation)
- [Risk Rating Matrix](#risk-rating-matrix)
- [Mitigation & Recommendations](#mitigation--recommendations)
- [ATT&CK Mapping](#attck-mapping)
- [References](#references)

---

## 🗂️ Executive Summary

This lab demonstrates a real-world attack chain against a vulnerable Linux server hosted on VulnHub (*DC: 1*).  
By chaining weak credentials, misconfigurations, and privilege escalation, an attacker gained root access and retrieved sensitive files.

**Business Impact:**  
A threat actor could pivot from an exposed web app to full server compromise, risking total loss of confidentiality and integrity.

**Key Takeaway:**  
Basic hardening, strong passwords, and proper patching would have prevented this compromise.

---

## 🎯 Objective

Demonstrate:
- Initial web foothold
- Privilege escalation to root
- Pivoting to access restricted data
- Reporting with risk ratings & actionable fixes

---

## 🧩 Lab Setup

- **Target VM:** VulnHub *DC: 1*
- **Attacker:** Kali Linux
- **Network:** Host-only or NAT
- **Tools:** Nmap, Gobuster, Hydra, Netcat, LinPEAS, Bloodhound (if AD present), Impacket (optional)

---

## 📌 Methodology

Based on **PTES** + **MITRE ATT&CK** mapping:
1. Reconnaissance
2. Enumeration
3. Exploitation
4. Privilege Escalation
5. Pivot & Exfiltration
6. Reporting

---

## 🔍 Reconnaissance

**Host Discovery & Port Scan**

```bash
nmap -sV -A <target-ip>
````

![nmap_scan](/screenshots/vulnhub/nmap_scan.png)

![netdiscovery](/screenshots/vulnhub/netdiscover.png)

![netdiscovery](/screenshots/vulnhub/netdiscovery_output.png)

**Result:**

* HTTP on 80
* SSH on 22

---

### 🔎 Web Enumeration

Used Gobuster:

```bash
gobuster dir -u http://<target-ip> -w /usr/share/wordlists/dirb/common.txt
```
![gobester](/screenshots/vulnhub/gobuster_dir.png)


Found `/admin` login portal.

---

## ⚡ Exploitation Chain

---

### 🗝️ Initial Foothold

* Found `admin` login page.
  
![drupal](/screenshots/vulnhub/drupal_site.png)

* Used default creds `admin:admin` or brute-forced with Hydra:

![hydra](/screenshots/vulnhub/hydra_user_pass.png)

![drupal_lockout](/screenshots/vulnhub/drupal_lockout_protection.png)


```bash
hydra -l admin -P ~/rockyou.txt 192.168.57.131 http-post-form "/?q=user/login:name=^USER^&pass=^PASS^&form_id=user_login&op=Log+in:F=200"
```

**Result:**
Hydra was not the best tool. Trying multiple passwords caused Drupal lockout protection and blocked my IP.

---

### 🗝️ Reverse Shell

**Used exploit:**

![metasploit](/screenshots/vulnhub/msf_search_exploit.png)

![metasploit](/screenshots/vulnhub/msf_drupalgeddon2.png)


Got a low-privilege shell.

![meterpreter](/screenshots/vulnhub/meterpreter_shell.png)

**Found:**

![meterpreter](/screenshots/vulnhub/meterpreter_snooping.png)

---

### 🛠️ Shell Upgrade

Upgraded shell to interactive:
* Listed `/root` → found `flag.txt`
  
![meterpreter](/screenshots/vulnhub/meterpreter_shell_flag1.png)

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```
![meterpreter](/screenshots/vulnhub/script_better_shell.png)


![meterpreter](/screenshots/vulnhub/shell_root.png)

**Result:**
Got root shell!
---


### 🔓 Privilege Escalation

![meterpreter](/screenshots/vulnhub/admin_n2_drupal_site.png)


### 🔗 Pivot & Exfiltration

* Checked `/etc/shadow`
* Downloaded flags:
* Found and downloaded salted and hashed admin password.

* Tried with Hydra and Hashcat but the crack would have taken too long. I used Hashes.com instead.

![meterpreter](/screenshots/vulnhub/hashcat_crack.png)

![meterpreter](/screenshots/vulnhub/hash_crack.png)

---
## 🔓 Post-Exploitation

* Verified root privileges.

![drupal](/screenshots/vulnhub/drupal_user_escalation.png)

![meterpreter](/screenshots/vulnhub/user_table.png)

![meterpreter](/screenshots/vulnhub/eric_user_admin.png)


* Dumped sensitive files (`shadow`, `passwd`).
* Would pivot to any internal hosts if this was an AD lab.
* Cleaned up shell and connection.
  
![meterpreter](/screenshots/vulnhub/drupal_tables.png)

![meterpreter](/screenshots/vulnhub/flood_table.png)

![meterpreter](/screenshots/vulnhub/clear_lockout.png)

---

## 🛡️ Risk Rating Matrix

| Vulnerability                 | CVSS | Risk     |
| ----------------------------- | ---- | -------- |
| Weak admin creds              | 6.0  | Medium   |
| Web shell upload (RCE)        | 9.0  | Critical |
| Privilege escalation via SUID | 8.0  | High     |
| Sensitive data exfiltration   | 9.0  | Critical |

---

## 🗝️ Mitigation & Recommendations

* Enforce strong passwords (min. 12 chars, complex).
* Restrict web admin panel to trusted IPs.
* Remove insecure SUID binaries.
* Patch kernel for local escalation vulns.
* Monitor logs for brute-force attempts.
* Run regular vulnerability scans.

---

## ⚔️ ATT\&CK Mapping

| Phase                | ATT\&CK ID | Technique                  |
| -------------------- | ---------- | -------------------------- |
| Initial Access       | T1190      | Exploit Public-Facing App  |
| Valid Accounts       | T1078      | Use of stolen creds        |
| Execution            | T1059      | Command & Scripting Interp |
| Privilege Escalation | T1068      | Exploitation for PrivEsc   |
| Exfiltration         | T1005      | Data from Local System     |

---

## 📚 References

* [VulnHub DC:1](https://www.vulnhub.com/entry/dc-1-1,292/)
* [LinPEAS](https://github.com/carlospolop/PEASS-ng)
* [MITRE ATT\&CK](https://attack.mitre.org/)

---

**End of Report**
